!function(w,d){"use strict";const G={URL:"https://opentdb.com/api.php?amount=33",fdata:{},SECONDS:30,elems:{},quest:0,score:0};function dataLoaded(data){G.fdata=data.results,G.elems.loader.style.display="none",readValue()[0]||(G.elems.star.innerHTML='This game is using <a href="https://en.wikipedia.org/wiki/Web_storage#Local_and_session_storage" target="_blank" rel="noopener noreferrer">localStorage</a>.'),G.quest>G.fdata.length&&(G.quest=0,G.score=0),updateStat(),G.quest=Number(readValue()[0])||0,G.score=Number(readValue()[1])||0,G.elems.starBtn.innerText=G.quest>0?"continue":"start",G.elems.starBtn.addEventListener("click",start)}function init(){const button=d.getElementById("starBtn"),getMainDiv=d.getElementById("main"),getQuestio=d.getElementById("ques"),getMessage=d.getElementById("mess"),starBtn=d.getElementById("starBtn"),star=d.getElementById("star"),stat=d.getElementById("usta"),scor=d.getElementById("usco"),seco=d.getElementById("seco"),imag=d.getElementById("imag"),loader=d.getElementById("loader");for(let i=0;i<=100;i++)!function(ind){setTimeout((function(){loader.childNodes[2].nodeValue=ind+"%"}),100+10*ind)}(i);this.elems={scor:scor,loader:loader,button:button,getMainDiv:getMainDiv,getQuestio:getQuestio,getMessage:getMessage,starBtn:starBtn,star:star,stat:stat,seco:seco,imag:imag}}function start(){hide.call(G.elems.getMessage),addQuestions(),setTimeout(show,500),updateStat(),countdown(),G.elems.getMainDiv.addEventListener("click",loopElems)}function addQuestions(){const{category:category,incorrect_answers:incorrect_answers,correct_answer:correct_answer,question:question}=G.fdata[G.quest],ins=getRandomIntInclusive(0,incorrect_answers.length);G.trueA="id"+ins;const incorrect=[...incorrect_answers];incorrect.splice(ins,0,correct_answer);const ans=[];for(let i=0,len=incorrect.length;i<len;i++)ans.push(new CreateElem("button","btn tips trans","id"+i,decodeEntities(incorrect[i])));ans.map(el=>G.elems.getMainDiv.appendChild(el)),G.elems.imag.innerText=category;const qu=new CreateElem("div","q","q",decodeEntities(question));G.elems.getQuestio.appendChild(qu)}function loopElems(elem){if(clearTimeout(G.tim),G.tim=0,!elem.target.classList.contains("tips"))return!1;sele.call(elem.target);const getAllansw=[...document.getElementsByClassName("tips")];getAllansw.forEach(element=>{element.id!==G.trueA?nno.call(element):yyes.call(element),element.disabled=!0,element.style.pointerEvents="none"});const answ=document.getElementById("id"+G.trueA);elem.target.id===G.trueA?(++G.score,createItem(G.quest,G.score),sele.bind(answ),yyes.call(G.elems.getQuestio),w.navigator.vibrate(20)):(nno.call(G.elems.getQuestio),nno.bind(answ),w.navigator.vibrate(100)),G.elems.getQuestio.className="bg",nextQuest()}function checkIsAllAnswered(){return G.quest===G.fdata.length&&(G.elems.star.innerText="Your score: "+G.score+"/"+G.fdata.length,G.fdata.length===G.score?(G.elems.star.innerText+="\nvictory!",G.elems.starBtn.innerText="Repeat"):G.elems.starBtn.innerText="Improve",G.quest=0,G.score=0,createItem(0,0),G.elems.getMessage.classList.remove("hide"),!0)}function nextQuest(){G.SECONDS=30,G.quest++,createItem(G.quest,G.score),setTimeout(()=>{if(checkIsAllAnswered())return remElements("img"),remElements("q"),remElements("main"),!1;remElements("img"),remElements("q"),remElements("main"),addQuestions(),setTimeout(show,500),countdown(),updateStat()},1500)}function remElements(elementId){const element=document.getElementById(elementId);element&&(element.children.length>0?element.innerHTML="":element.parentNode.removeChild(element))}function hide(){void 0!==this&&this.classList.add("hide")}function sele(){void 0!==this&&this.classList.add("sele")}function yyes(){void 0!==this&&this.classList.add("yyes")}function nno(){void 0!==this&&this.classList.add("nno")}function countdown(){G.elems.seco.innerText=G.SECONDS,--G.SECONDS>0?G.tim=setTimeout(()=>{countdown()},1e3):(clearTimeout(G.tim),G.tim=0,nextQuest())}function CreateElem(e,className,id,text){return this instanceof CreateElem?(e=document.createElement(e),id&&(e.id=id),className&&(e.className=className),text&&(e.innerText=text),e):new CreateElem(e,className,id)}function show(){const elems=[...document.getElementsByClassName("tips")];for(let i=elems.length-1;i>=0;i--)elems[i].classList.toggle("trans")}function updateStat(){G.elems.stat.innerText=Number(G.quest)+1+"/"+G.fdata.length,G.elems.scor.innerText=G.score}function getRandomIntInclusive(min,max){return min=Math.ceil(min),max=Math.floor(max),Math.floor(Math.random()*(max-min+1)+min)}d.addEventListener("DOMContentLoaded",init.bind(G,this));const decodeEntities=function(){const element=document.createElement("div");function decodeHTMLEntities(str){return str&&"string"==typeof str&&(str=(str=str.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),element.innerHTML=str,str=element.textContent,element.textContent=""),str}return decodeHTMLEntities}();function createItem(q,s){if(!storageAvailable("localStorage"))return!1;w.localStorage.setItem("Game-guestionaire-question",q),w.localStorage.setItem("Game-guestionaire-score",s)}function readValue(){if(storageAvailable("localStorage")){const x=w.localStorage.getItem("Game-guestionaire-question"),a=w.localStorage.getItem("Game-guestionaire-score");return[x,a]}return!1}function storageAvailable(type){try{const storage=w[type],x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return!1}}function CheckError(response){if(response.status>=200&&response.status<=299)return response.json();throw Error(response.statusText)}w.fetch(G.URL).then(CheckError).then(json=>dataLoaded(json))}(window,document);